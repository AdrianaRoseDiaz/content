This is a wrapper to isolate or unisolate hash list from XDR, MSDE or CrowdStrike (Available from Cortex XSOAR 6.0.0).

## Script Data
---

| **Name** | **Description** |
| --- | --- |
| Script Type | python3 |
| Tags | basescript |
| Cortex XSOAR Version | 6.0.0 |

## Inputs
---

| **Argument Name** | **Description** |
| --- | --- |
| device_ids | Device ids to isolate or unisolate |
| action | The action to do with device ids - isolate or unisolate |

## Outputs
---

| **Path** | **Description** | **Type** |
| --- | --- | --- |
| MicrosoftATP.MachineAction.ID | The machine action ID. | String |
| MicrosoftATP.MachineAction.Type | Type of the machine action. | String |
| MicrosoftATP.MachineAction.Scope | Scope of the action. | Unknown |
| MicrosoftATP.MachineAction.Requestor | The ID of the user that executed the action. | String |
| MicrosoftATP.MachineAction.RequestorComment | Comment that was written when issuing the action. | String |
| MicrosoftATP.MachineAction.Status | The current status of the command. | String |
| MicrosoftATP.MachineAction.MachineID | The machine ID on which the action was executed. | String |
| MicrosoftATP.MachineAction.ComputerDNSName | The machine DNS name on which the action was executed. | String |
| MicrosoftATP.MachineAction.CreationDateTimeUtc | The date and time when the action was created. | Date |
| MicrosoftATP.MachineAction.LastUpdateTimeUtc | The last date and time when the action status was updated. | Date |
| MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier | The file identifier. | String |
| MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType | The type of the file identifier. Possible values: "SHA1" ,"SHA256", and "MD5". | String |
| PaloAltoNetworksXDR.Isolation.endpoint_id | The endpoint ID. | String |
| PaloAltoNetworksXDR.UnIsolation.endpoint_id | Isolates the specified endpoint. | String |


## Script Examples
### Example command
```!IsolationAssetWrapper action=unisolate device_ids=15dbb9d8f06b45fe9f61eb46e829d986,046761c46ec84f40b27b6f79ce7cd32c```
### Context Example
```json
{}
```

### Human Readable Output

>### Results Summary
>|Instance|Command|Result|Comment|
>|---|---|---|---|
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1 | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 15dbb9d8f06b45fe9f61eb46e829d986 | Error | Error: Endpoint 1<XX_REPLACED>dbb9d8f06b4<XX_REPLACED>fe9f61eb46e829d986 was not found |
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1_copy | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 15dbb9d8f06b45fe9f61eb46e829d986 | Error | Error: Endpoint 1<XX_REPLACED>dbb9d8f06b4<XX_REPLACED>fe9f61eb46e829d986 was not found |
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1 | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 046761c46ec84f40b27b6f79ce7cd32c | Error | Error: Endpoint 046761c46ec84f40b27b6f79ce7cd32c was not found |
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1_copy | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 046761c46ec84f40b27b6f79ce7cd32c | Error | Error: Endpoint 046761c46ec84f40b27b6f79ce7cd32c was not found |
>| ***Microsoft Defender Advanced Threat Protection***: Microsoft Defender Advanced Threat Protection_instance_1 | <br/>***command***: microsoft-atp-unisolate-machine<br/>**args**:<br/>	***machine_id***: 15dbb9d8f06b45fe9f61eb46e829d986,046761c46ec84f40b27b6f79ce7cd32c<br/>	***comment***: XSOAR - related incident ab57e22c-ad03-4aba-8b6c-b42bd895a116 | Error | Microsoft Defender ATP The command was failed with the errors: {'15dbb9d8f06b45fe9f61eb46e829d986': NotFoundError({'error': {'code': 'ResourceNotFound', 'message': 'Machine 15dbb9d8f06b45fe9f61eb46e829d986 was not found. OrgId: b7df6ab7-5c73-4e13-8cd3-82e1f3d849ed.', 'target': '6d2e0d64-8698-4a4c-84d8-fb8e1282249e'}}), '046761c46ec84f40b27b6f79ce7cd32c': NotFoundError({'error': {'code': 'ResourceNotFound', 'message': 'Machine 046761c46ec84f40b27b6f79ce7cd32c was not found. OrgId: b7df6ab7-5c73-4e13-8cd3-82e1f3d849ed.', 'target': '4b91dfc2-2d60-486e-911e-0fa97c855e9e'}})} |
>| ***CrowdstrikeFalcon***: CrowdstrikeFalcon_instance_1 | <br/>***command***: cs-falcon-lift-host-containment<br/>**args**:<br/>	***ids***: 15dbb9d8f06b45fe9f61eb46e829d986,046761c46ec84f40b27b6f79ce7cd32c | Error | Error in API call to CrowdStrike Falcon: code: 409 - reason: Conflict<br/>Device 15dbb9d8f06b45fe9f61eb46e829d986 is not eligible to perform lift_containment action<br/>Device 046761c46ec84f40b27b6f79ce7cd32c is not eligible to perform lift_containment action |


### Example command
```!IsolationAssetWrapper action=unisolate device_ids=96444b946be252d1f4550354edef5fdc23aca2c5,4899036531e374137f63289c3267bad772c13fef```
### Context Example
```json
{}
```

### Human Readable Output

>### Results Summary
>|Instance|Command|Result|Comment|
>|---|---|---|---|
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1_copy | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 96444b946be252d1f4550354edef5fdc23aca2c5 | Error | Error: Endpoint 96444b946be2<XX_REPLACED>2d1f4<XX_REPLACED><XX_REPLACED>03<XX_REPLACED>4edef<XX_REPLACED>fdc23aca2c<XX_REPLACED> was not found |
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1 | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 96444b946be252d1f4550354edef5fdc23aca2c5 | Error | Error: Endpoint 96444b946be2<XX_REPLACED>2d1f4<XX_REPLACED><XX_REPLACED>03<XX_REPLACED>4edef<XX_REPLACED>fdc23aca2c<XX_REPLACED> was not found |
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1 | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 4899036531e374137f63289c3267bad772c13fef | Error | Error: Endpoint 4899036<XX_REPLACED>31e374137f63289c3267bad772c13fef was not found |
>| ***Cortex XDR - IR***: Cortex XDR - IR_instance_1_copy | <br/>***command***: xdr-unisolate-endpoint<br/>**args**:<br/>	***endpoint_id***: 4899036531e374137f63289c3267bad772c13fef | Error | Error: Endpoint 4899036<XX_REPLACED>31e374137f63289c3267bad772c13fef was not found |
>| ***Microsoft Defender Advanced Threat Protection***: Microsoft Defender Advanced Threat Protection_instance_1 | <br/>***command***: microsoft-atp-unisolate-machine<br/>**args**:<br/>	***machine_id***: 96444b946be252d1f4550354edef5fdc23aca2c5,4899036531e374137f63289c3267bad772c13fef<br/>	***comment***: XSOAR - related incident ab57e22c-ad03-4aba-8b6c-b42bd895a116 | Error | Microsoft Defender ATP The command was failed with the errors: {'4899036531e374137f63289c3267bad772c13fef': DemistoException('Error in API call [400] - Bad Request\n{"error": {"code": "BadRequest", "message": "Cannot isolate device because Isolate action: 35adc459-4897-4c6c-b279-4c729ff55e44 is still active.", "target": "128cf82d-fc52-4da5-b1b4-19789d4077ee"}}', None), '96444b946be252d1f4550354edef5fdc23aca2c5': DemistoException('Error in API call [400] - Bad Request\n{"error": {"code": "BadRequest", "message": "Cannot isolate device because Unisolate action: 1af7878f-d6d2-417a-abb2-88b23a85dd57 is still active.", "target": "24da2c1b-1bad-45d1-aa9c-20f693ac5f29"}}', None)} |
>| ***CrowdstrikeFalcon***: CrowdstrikeFalcon_instance_1 | <br/>***command***: cs-falcon-lift-host-containment<br/>**args**:<br/>	***ids***: 96444b946be252d1f4550354edef5fdc23aca2c5,4899036531e374137f63289c3267bad772c13fef | Error | Error in API call to CrowdStrike Falcon: code: 404 - reason: Not Found<br/>No matching device found for ID 96444b946be252d1f4550354edef5fdc23aca2c5<br/>No matching device found for ID 4899036531e374137f63289c3267bad772c13fef |

